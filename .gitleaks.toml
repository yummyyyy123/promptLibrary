# Gitleaks Configuration
# https://github.com/gitleaks/gitleaks

title = "gitleaks config"

# Extend the base configuration
[extend]
useDefault = true

# Custom rules for your specific patterns
[[rules]]
description = "Supabase Service Key"
id = "supabase-service-key"
regex = '''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9\.eyJ[0-9a-zA-Z_-]+\.[0-9a-zA-Z_-]+\.[0-9a-zA-Z_-]+'''
keywords = ["supabase", "service", "key"]

[[rules]]
description = "JWT Secret"
id = "jwt-secret"
regex = '''(?i)(jwt[_-]?secret|secret[_-]?jwt)\s*[:=]\s*['\"]?[0-9a-zA-Z+/=]{16,}['\"]?'''
keywords = ["jwt", "secret"]

[[rules]]
description = "Database URL"
id = "database-url"
regex = '''(?i)(database[_-]?url|db[_-]?url|postgres|postgresql)://[^\s]+'''
keywords = ["database", "url", "postgres", "postgresql"]

[[rules]]
description = "API Key Pattern"
id = "api-key"
regex = '''(?i)(api[_-]?key|apikey)\s*[:=]\s*['\"]?[0-9a-zA-Z]{16,}['\"]?'''
keywords = ["api", "key"]

[[rules]]
description = "Private Key"
id = "private-key"
regex = '''-----BEGIN (RSA )?PRIVATE KEY-----'''
keywords = ["private", "key"]

[[rules]]
description = "Password in Code"
id = "password-in-code"
regex = '''(?i)(password|passwd|pwd)\s*[:=]\s*['\"]?[^\s'"]{4,}['\"]?'''
keywords = ["password", "passwd", "pwd"]

# Allowlist for false positives
[allowlist]
description = "Global allowlist"
paths = [
  '''node_modules''',
  '''\.git''',
  '''\.vscode''',
  '''dist''',
  '''build''',
  '''coverage''',
  '''\.env\.example''',
  '''env\.example''',
  '''package-lock\.json''',
  '''yarn\.lock'''
]

# Allow specific files that might contain false positives
[[allowlist.files]]
description = "Test files"
path = '''\.test\.'''
[[allowlist.files]]
description = "Mock files"
path = '''mock'''
[[allowlist.files]]
description = "Example files"
path = '''example'''

# Allow specific commits or branches
[[allowlist.commits]]
description = "Test commit"
hash = "abc123"

# Allow specific lines
[[allowlist.regexes]]
description = "Example password"
regex = '''password\s*=\s*['"]change-me['"]'''
[[allowlist.regexes]]
description = "Example secret"
regex = '''secret\s*=\s*['"]your-secret-key['"]'''
